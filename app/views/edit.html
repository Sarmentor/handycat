<div ng-controller="TabsCtrl">
    <cat-nav></cat-nav>
    <!-- TODO: add feature where dragging a word or phrase to target area translates it automatically -->
    <!-- UPDATE: use glossary for the 'add word' feature -->
    <!-- TODO: get the TM matches for the source segment -->

    <!-- This hr uses some space vertical space so the nav-bar do not hide part of the first segment -->
    <hr>

    <!-- translation area -->
    <div class="edit-area-wrapper" ng-controller="ContentAreaCtrl" ng-show="tabs[0].active">

        <div class="segment row" ng-controller="SegmentAreaCtrl" ng-repeat="seg in segments" index="$index"
             ng-init="segment = seg; init($index); segmentNumber = $index">
            <a id="segment-{{$index}}"></a>

            <p class="segment-index-label">Segment Index: {{$index}}
                <span class="segment-finished" ng-show="segmentState.completed">
                    <button type="button" class="btn btn-default btn-xs">
                        <span class="glyphicon glyphicon-ok"></span> Complete
                    </button>
                </span>
                <span class="segment-finished" ng-hide="segmentState.completed">
                   <button type="button" class="btn btn-default btn-xs">
                       <span class="glyphicon glyphicon-flag"></span> Pending
                   </button>
                </span>
            </p>

            <div class="bottom-margin" ng-click="activate($index)">
                <div class="row">
                    <div class="col-sm-6 bottom-margin">
                        <div class="row">
                            <div class="col-xs-11">
                                <div ng-show="segmentState.completed" class="ace_editor target segment-finished-target frame" ng-click="reopen($index)">
                                    <p>{{segment.source}}</p>
                                </div>
                                <div ng-hide="segmentState.completed" class="content-card frame">
                                    <div class="source">
                                        <source-area ng-init="setSource(segment.source)" source-sentence="segment.source"></source-area>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- working - prototyping dynamic addition of the Ace Editor -->
                    <div class="col-sm-6 bottom-margin">
                        <div class="row">
                            <div class="col-xs-11">
                                <static-target text="{{segment.target}}"></static-target>
                            </div>
                        </div>
                    </div>
                    <!--<div ng-controller="AceCtrl" class="col-sm-6">-->
                        <!--<div class="row">-->
                            <!--<div ng-show="segmentState.completed" class="ace_editor target segment-finished-target frame" ng-click="reopen($index)">-->
                                <!--<p>{{segment.target}}</p>-->
                            <!--</div>-->
                            <!--<div ng-hide="segmentState.completed" class="editor-area">-->
                                <!--<div class="col-xs-11">-->
                                    <!--<div index="{{$index}}" class="content-card frame">-->
                                        <!--&lt;!&ndash; the ace editor &ndash;&gt;-->
                                        <!--<div class="ace_editor target" id="ace_editor-{{$index}}" ng-model="segment.target"-->
                                             <!--ui-ace="{ onLoad : aceLoaded }" ng-paste="onPaste($event)" ng-copy="onCopy($event)"></div>-->
                                        <!--&lt;!&ndash;<div chars class="sample-show-hide" collapsed="showSpecialChars" special="germanChars" selected="insertChar(char)" ></div>&ndash;&gt;-->
                                    <!--</div>-->
                                <!--</div>-->
                                <!--<div class="reorder-toolbar col-xs-1 move-left" ng-show="isActive.active && project.showSmartButtons">-->
                                  <!--<button logger="edit-mode-switch" tooltip="switch edit mode" tooltip-placement="right" ng-click="changeEditMode()" ng-disabled="segmentState.completed" class="btn btn-primary mode-glyph">-->
                                        <!--<span>E</span>-->
                                  <!--</button>-->
                                    <!--<button logger="edit-mode-next" tooltip="previous token" tooltip-placement="right" ng-click="selectPrevRange()" ng-disabled="segmentState.completed" class="btn btn-primary mode-glyph">-->
                                        <!--<span style="font-size: 7px" class="glyphicon glyphicon-arrow-left"></span>-->
                                    <!--</button>-->
                                  <!--<button logger="edit-mode-next" tooltip="next token" tooltip-placement="right" ng-click="selectNextRange()" ng-disabled="segmentState.completed" class="btn btn-primary mode-glyph">-->
                                      <!--<span style="font-size: 7px" class="glyphicon glyphicon-arrow-right"></span>-->
                                  <!--</button>-->
                                  <!--<button logger="edit-mode-move" tooltip="move range" tooltip-placement="right" ng-click="moveCurrentEditRange()" ng-disabled="segmentState.completed" class="btn btn-primary mode-glyph">-->
                                      <!--<span style="font-size: 7px" class="ion-arrow-move"></span>-->
                                  <!--</button>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->

                <!-- The tools for editing -->
                <!--<div class="ace-toolbar container" ng-show="toolbarOpen" collapse="toolbarOpen">-->

                <!--<div class="info-toolbar" collapse="isCollapsed['collapsed'] || segmentState.completed" ng-show="isActive.active">-->
                    <!--<div-->
                        <!--class="translation-toolbar"-->
                    <!-->
                    <!--&lt;!&ndash; Working - move to tabset &ndash;&gt;-->
                    <!--&lt;!&ndash; Working - Add smart pluralize here first, then move to the edit area &ndash;&gt;-->
                    <!--&lt;!&ndash; TODO - make tabs active based on edit-area interactions &ndash;&gt;-->
                        <!--<tabset>-->
                            <!--<tab heading="Glossary" ng-click="">-->
                                <!--<input type="text" ng-model="glossary.glossaryQuery" placeholder="Enter a search query..." class="query-box"/>-->
                                <!--<button logger="query-glossary" ng-click="queryGlossary(glossary.glossaryQuery)" class="glossary-search btn btn-success"><span class="glyphicon glyphicon-search"></span></button>-->
                                <!--<div class="search-result"-->
                                     <!--ng-repeat="glossaryMatch in glossaryMatches"-->
                                     <!--ng-click="insertText(glossaryMatch)"-->
                                     <!--ng-show="glossaryMatches"-->
                                <!--{{glossaryMatch}}</div>-->

                                <!--<div ng-hide="glossaryMatches !== undefined"><p>Error: Unable to access the glossary service.</p></div>-->
                                <!--<div ng-show="glossaryMatches.length === 0"><p>No matches found for term: <b>{{ glossary.glossaryQuery }}</b></p></div>-->
                            <!--</tab>-->
                            <!--<tab heading="Concordance" ng-click="">-->
                                <!--<input type="text" ng-model="concordanceQuery" placeholder="Enter a search query..." class="query-box" />-->
                                <!--<button logger="concordance-query" ng-click="queryConcordancer(concordanceQuery, queryLang)" class="btn btn-success"><span class="glyphicon glyphicon-search"></span></button>-->
                                <!--<div class="btn-group">-->
                                    <!--<button type="button" class="btn btn-primary lang-select" btn-radio="'en'" ng-model="queryLang">EN</button>-->
                                    <!--<button type="button" class="btn btn-primary lang-select" btn-radio="'de'" ng-model="queryLang">DE</button>-->
                                <!--</div>-->
                                <!--<div class="search-result"-->
                                     <!--ng-repeat="concordanceMatch in concordanceMatches"-->
                                     <!--ng-bind-html="getSnippet(concordanceMatch)"-->
                                     <!--ng-hide="concordancerError"-->
                                <!--</div>-->

                                <!--<div ng-show="concordancerError"><p>Error: Unable to access the concordance service.</p></div>-->
                            <!--</tab>-->

                            <!--<tab heading="WordForms" ng-show="false">-->
                                <!--<div class="word-forms">-->
                                    <!--<div-->
                                            <!--ng-repeat="word in otherWordForms"-->
                                        <!--<button logger="word-forms-replace" class="btn btn-default" ng-click="replaceSelection(word)">{{word}}</button>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</tab>-->
                            <!--<tab ng-show="project.showSmartButtons">-->
                                <!--<tab-heading>-->
                                    <!--Edit history <span class="badge" ng-show="editHistory.length">{{editHistory.length}}</span>-->
                                <!--</tab-heading>-->
                                <!--<div class="edit-history">-->
                                    <!--<p>List of edits performed in this segment</p>-->

                                    <!--<div ng-repeat="edit in editHistory track by $index">-->
                                        <!--{{edit.description}}-->
                                        <!--<button type="button" class="btn btn-default" ng-hide="segmentNumber != edit.segment" ng-click="propagateEdit($index)">-->
                                            <!--<span class="glyphicon glyphicon-fullscreen"></span> Propagate to other segments-->
                                        <!--</button>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</tab>-->
                            <!--<tab heading="Entities" ng-show="false">-->
                                <!--<div class="named-entities">-->
                                    <!--<div>-->
                                        <!--<div>Entity: <a ng-href="http://dbpedia.org/resource/{{entities.currentEntity.name}}">{{entities.currentEntity.name}}</a></div>-->
                                        <!--<div class="surface-form" ng-repeat="sf in entities.currentEntity.surfaceForms | orderBy:'-count'">-->
                                            <!--&lt;!&ndash; on click, insert entity &ndash;&gt;-->
                                            <!--<div ng-click="insertSurfaceForm(sf.name)">{{sf.name}}: {{sf.count}}</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</tab>-->
                        <!--</tabset>-->

                    <!--</div>-->
                <!--</div>-->
                <hr/>
            </div>
        </div>
    </div>

    <div ng-show="checkTranslationCompleted()" id="footmsg">
        <h2>Translation Job completed!</h2>
    </div>

    <!--
    <div ng-controller="StatsController">
        <p>Stats</p>
        <div ng-repeat="s in log">
            <p>{{s[3]}}: {{s[0]}} {{s[1]}} {{s[2]}}</p>
        </div>
    </div> -->
</div>